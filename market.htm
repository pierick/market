<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script type="text/javascript">

/**
*
*/
function ordre(prix, quantite, sens) {
    //date = new Date();  
    //this.id = id;
    this.prix = prix;
    this.quantite = quantite;
	this.sens = sens;
    //this.date = date.getTime();
    if(quantite && prix && (sens == 'A' || sens == 'V')) {
        carnet.add(this);
    }
};

/**
*
*/
function carnet() {
  this.achats = new Array();
  this.ventes = new Array();
}
carnet.prototype.add = function(ordre) {

	if(ordre.sens == "A") {
		this.achats.push(ordre);
	}
	else if(ordre.sens == "V") {
		this.ventes.push(ordre);
	}
	
	this.sort();
	
	if(this.achats[0] && this.ventes[0]) {
		if(this.achats[0]["prix"] >= this.ventes[0]["prix"]) {
			//console.debug(this.achats[0]["prix"], this.ventes[0]["prix"]);
			
			q = this.achats[0]["quantite"] - this.ventes[0]["quantite"];
			
			if(q >= 0) {
				this.achats.shift();
			} else if(q <= 0) {
				this.ventes.shift();
			}
			
			// this.add ...
			
		}
	}
	
	/*
	for (var i = 0; i < colors.length; i++) {
		alert(colors[i]);
	}
	*/

	
}
carnet.prototype.sort = function() {
    function cmp(x, y) {
        return x > y ? 1 : x < y ? -1 : 0;
    }
    this.achats.sort(function(a, b) {
        return [
            -cmp(a.prix, b.prix), cmp(a.id, b.id)
        ] < [
            -cmp(b.prix, a.prix), cmp(b.id, a.id)
        ] ? -1 : 1;
    });
    this.ventes.sort(function(a, b) {
        return [
            cmp(a.prix, b.prix), cmp(a.id, b.id)
        ] < [
            cmp(b.prix, a.prix), cmp(b.id, a.id)
        ] ? -1 : 1;
    });
}


/*---------------------------------------------------------*/

carnet = new carnet();

o = new ordre(60, 50, 'V');
o = new ordre(10, 40, 'A');
o = new ordre(20, 30, 'A');
o = new ordre(30, 50, 'V');
o = new ordre(20, 40, 'A');
o = new ordre(60, 20, 'V');
o = new ordre(10, 40, 'V');
o = new ordre(20, 40, 'A');
o = new ordre(20, 50, 'V');
o = new ordre(30, 40, 'A');

console.debug(carnet);



</script>

</head>
<body>

</body>
</html>
